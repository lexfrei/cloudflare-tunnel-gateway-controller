# Managed cloudflared example
# Deploy and manage cloudflared alongside the controller
#
# This configuration enables Helm-managed cloudflared deployment
# which automatically connects to your Cloudflare Tunnel.
#
# Prerequisites:
#   1. Create a secret with the API token:
#      kubectl create secret generic cloudflare-credentials \
#        --namespace cloudflare-tunnel-system \
#        --from-literal=api-token="your-api-token"
#
#   2. Create a secret with the tunnel token:
#      kubectl create secret generic cloudflare-tunnel-token \
#        --namespace cloudflare-tunnel-system \
#        --from-literal=tunnel-token="your-tunnel-token"
#
# Usage:
#   helm install cloudflare-tunnel-gateway-controller \
#     oci://ghcr.io/lexfrei/cloudflare-tunnel-gateway-controller-chart \
#     --namespace cloudflare-tunnel-system \
#     --create-namespace \
#     --values managed-cloudflared-values.yaml

gatewayClassConfig:
  create: true

  # Cloudflare Tunnel ID (required)
  tunnelID: "your-tunnel-id"

  # Reference to Secret containing Cloudflare API credentials
  cloudflareCredentialsSecretRef:
    name: "cloudflare-credentials"

  # Reference to Secret containing tunnel token
  # Get from: Zero Trust Dashboard > Networks > Tunnels > Configure
  tunnelTokenSecretRef:
    name: "cloudflare-tunnel-token"

  # Cloudflared deployment configuration
  cloudflared:
    # Enable Helm-managed cloudflared deployment
    enabled: true

    # Number of replicas for high availability
    replicas: 2

    # Namespace for cloudflared deployment
    namespace: "cloudflare-tunnel-system"

    # Transport protocol (optional: auto, quic, http2)
    # protocol: "quic"
